# 情景背单词小程序使用说明

## 📖 项目简介

这是一个基于MetaGPT AI的情景化英语学习应用，通过AI生成个性化故事帮助用户在语境中记忆单词。

## 🚀 快速开始

### 1. 环境准备

确保您的系统已安装：
- **Python 3.9+**
- **Node.js 16+**
- **npm 或 yarn**

### 2. 下载项目

```bash
# 克隆或下载项目到本地
cd /path/to/your/workspace
# 项目文件应该在 vocabulary_story_app/ 目录中
```

### 3. 配置AI模型（三选一）

#### 方案一：本地开源模型（推荐，完全免费） ⭐⭐⭐
1. 下载并安装 [Ollama](https://ollama.ai/download)
2. 安装开源模型：
   ```bash
   # 安装推荐的Llama 3.2模型（约2GB）
   ollama pull llama3.2

   # 或者安装其他优秀模型：
   ollama pull qwen2.5:7b    # 腾讯Qwen模型（中文支持优秀）
   ollama pull mistral:7b    # Mistral模型（性能均衡）
   ```
3. 配置文件已预设为Ollama，无需修改

#### 方案二：免费在线服务
注册 [Groq](https://groq.com/) 获取免费API密钥，修改配置：
```yaml
llm:
  api_type: "groq"
  model: "llama3-8b-8192"
  base_url: "https://api.groq.com/openai/v1"
  api_key: "YOUR_GROQ_API_KEY"
```

#### 方案三：付费API服务（如需要更高性能）
```yaml
llm:
  api_type: "openai"  # 或 azure, anthropic, google 等
  model: "gpt-3.5-turbo"  # 或 gpt-4, claude-3 等
  base_url: "https://api.openai.com/v1"
  api_key: "YOUR_API_KEY"  # 🔑 替换为您的API密钥
```

**支持的AI服务：**
- Ollama (本地开源模型 - **完全免费**)
- Groq (Grok模型 - 免费额度)
- OpenAI (GPT-3.5/4 - 付费)
- Azure OpenAI (付费)
- Anthropic Claude (付费)
- Google Gemini (付费)
- DeepSeek (免费额度)

### 4. 一键启动

#### Windows用户：
```bash
# ⭐ 最简单：一键启动（自动检测、安装、启动全部搞定）
双击运行 一键启动.bat

# 🚀 如果安装慢：加速安装依赖
双击运行 加速安装.bat

# ⚡ 如果已安装：快速启动（跳过安装）
双击运行 快速启动.bat

# 其他方法：
# 方法1: 完整启动（推荐，包含AI模型检查和自动下载）
双击运行 start_services.bat

# 方法2: 基础快速启动
双击运行 quick_start.bat

# 方法3: 仅安装AI模型
双击运行 install_ollama.bat
```

#### Linux/Mac用户：
```bash
chmod +x start.sh
./start.sh
```

### 5. 手动启动

如果一键启动脚本有问题，可以手动启动：

**启动后端服务：**
```bash
cd backend
python -m venv venv
# Windows:
venv\Scripts\activate
# Linux/Mac:
source venv/bin/activate

pip install -r requirements.txt
python app.py
```

**启动前端服务：**
```bash
cd frontend
npm install
npm start
```

### 6. 测试AI功能（可选）

运行AI测试脚本验证Ollama是否正常工作：

```bash
python test_ollama.py
```

### 7. 访问应用

- 前端界面：http://localhost:3001
- 后端API：http://localhost:5000

## 🎯 功能介绍

### 1. 首页概览
- 📊 学习统计数据（支持FSRS算法统计）
- 📚 今日单词预览
- 🎯 本周学习目标进度
- 🚀 快速开始学习

### 2. 单词学习
- 📖 卡片式单词学习
- 🔊 语音发音播放
- ⚙️ 自定义学习设置
- 📈 学习进度跟踪

### 3. 单词复习（新增）
- 🧠 **FSRS智能算法**：基于遗忘曲线的最优复习时间安排
- 🎤 **语音识别练习**：实时发音评估，听说结合学习
- ⭐ **四级评分系统**：Again(1)/Hard(2)/Good(3)/Easy(4)
- 📊 **复习统计**：详细的学习状态跟踪
- ⏰ **智能提醒**：自动计算下次复习时间

### 4. 故事阅读器
- 🤖 AI生成个性化故事
- 🎭 多种故事类型（冒险、悬疑、爱情、科幻、日常生活）
- 📏 不同长度选择
- 🔍 单词高亮显示
- 📢 故事语音朗读

### 4. 学习统计
- 📈 详细的学习数据
- 🏆 学习等级系统
- 📅 学习历史记录
- 💡 个性化学习建议

### 5. 设置中心
- 🎨 界面主题设置
- 🔊 语音功能配置
- 📚 学习偏好设置
- ⏰ 学习提醒设置

## 📚 使用指南

### 开始学习

1. **设置偏好**：在设置页面选择适合您的单词等级和故事类型
2. **单词学习**：进入单词学习页面，跟随卡片学习新单词
3. **生成故事**：选择5-10个单词，让AI生成情景故事
4. **阅读故事**：在故事中遇到学过的单词，会高亮显示
5. **复习巩固**：定期查看学习统计，调整学习计划

### 单词数据

项目内置了以下等级的单词：
- **CET4**：大学英语四级词汇
- **CET6**：大学英语六级词汇
- **TOEFL**：托福词汇
- **IELTS**：雅思词汇

### 故事类型

- **冒险故事**：充满刺激和探索的情节
- **悬疑故事**：包含谜团和推理元素
- **爱情故事**：情感细腻动人的故事情节
- **科幻故事**：未来科技主题的幻想故事
- **日常生活**：贴近现实生活的实用场景

## 🔧 高级配置

### MetaGPT配置

在 `config/metagpt_config.yaml` 中可以配置：

```yaml
llm:
  api_type: "openai"
  model: "gpt-4-turbo"
  api_key: "your-api-key"
  temperature: 0.7  # 创造性程度
  max_tokens: 2000  # 最大token数

# 其他可选配置
repair_llm_output: true
proxy: "http://your-proxy:port"
```

### 应用配置

`config/app_config.json` 包含应用的基本设置：

```json
{
  "server": {
    "host": "localhost",
    "port": 5000
  },
  "vocabulary": {
    "default_level": "CET4",
    "daily_words_count": 10
  }
}
```

## 🔧 故障排除

### 🚀 一键诊断工具

**推荐使用自动诊断脚本：**
```bash
# 运行端口连接测试
python test_ports.py

# 或运行完整故障排除
troubleshoot.bat
```

### ❓ 常见问题

#### Q: "拒绝连接"错误
A: 浏览器无法连接到 http://localhost:3001
```bash
# 解决方案：
1. 运行诊断: python test_ports.py
2. 检查端口占用: netstat -ano | findstr "3001"
3. 重新启动: start_services.bat
4. 检查防火墙设置
```

#### Q: 前端页面空白或无法加载
A: 前端服务可能未启动或端口冲突
```bash
# 检查前端服务:
cd frontend && npm start

# 如果端口3001被占用，编辑 package.json 更换端口
```

#### Q: 后端API连接失败
A: 后端服务未运行或端口5000被占用
```bash
# 检查后端服务:
cd backend && python app.py

# 测试API连接:
curl http://localhost:5000/api/health
```

#### Q: AI故事生成失败
A: Ollama服务或模型问题
```bash
# 检查Ollama状态
ollama list
ollama ps

# 测试AI功能
python test_ollama.py

# 重新安装模型
ollama pull llama3.2
```

#### Q: 语音识别不工作
A: 浏览器权限或兼容性问题
- ✅ 使用Chrome/Safari浏览器
- 🎤 允许麦克风权限
- 🔒 HTTPS环境下更稳定
- 🌐 检查浏览器语音API支持

#### Q: MetaGPT未配置
A: 检查 `config/metagpt_config.yaml` 文件
- 确保Ollama服务正在运行
- 检查模型是否正确下载
- 验证配置文件语法

#### Q: 如何添加新单词
A: 编辑 `data/vocabulary.json` 文件，添加新的单词条目

#### Q: 学习数据丢失
A: 检查 `data/user_data.json` 文件权限
- 确保应用程序有写入权限
- 备份重要数据到其他位置

## 🛠️ 开发说明

### 项目结构

```
vocabulary_story_app/
├── backend/          # Python Flask后端
├── frontend/         # React前端应用
├── config/           # 配置文件
├── data/            # 数据文件
└── docs/            # 文档
```

### 技术栈

- **后端**：Python Flask + MetaGPT
- **前端**：React + Material-UI
- **数据存储**：JSON文件（可扩展为数据库）
- **AI引擎**：MetaGPT（支持多种LLM）

### 扩展开发

1. **添加新功能**：在 `frontend/src/pages/` 中添加新页面
2. **扩展API**：在 `backend/app.py` 中添加新的路由
3. **自定义单词**：修改 `data/vocabulary.json`
4. **数据库集成**：将JSON存储替换为SQLite或PostgreSQL

## 📄 许可证

本项目仅供学习和个人使用，请遵守相关AI服务的条款和条件。

## 🤝 贡献

欢迎提交Issue和Pull Request来改进这个项目！

## 📞 联系我们

如果您在使用过程中遇到问题或有建议，请：
1. 检查本文档的常见问题部分
2. 查看GitHub Issues
3. 提交新的Issue描述您的问题
